<div id="app" @keydown.meta.f="activateSearch()" tabindex="-1" style="height: inherit; outline: none;">
  <div class="e-layout e-layout-without_navigation e-fullheight" style="display: flex;">
    <header class="e-layout__header">
      <h1 class="e-layout__title">GAP Secret Editor</h1>
    </header>
    <main class="e-layout__content" style="flex-grow: 1;">
      <section class="e-layout__section e-padding-s" style="display: flex; flex-direction: column;">

        <div class="e-grid e-grid-small">
          <div class="e-cell e-cell-small">
            <e-select
                :items="JSON.stringify(availableContexts)"
                :loading="loading.contextList"
                @change="selectContext($event.target.value)"
            ></e-select>
          </div>
          <div class="e-cell e-cell-small">
            <e-select
                id="namespace-selector"
                placeholder="Select your namespace"
                :items="JSON.stringify(namespaces)"
                :loading="loading.namespaceList"
                @change="selectNamespace($event.target.value)"
            ></e-select>
          </div>

          <div class="e-cell e-cell-small">
            <e-select
                id="secret-selector"
                :disabled="secretNamespace === ''"
                placeholder="Select your secret"
                :items="JSON.stringify(namesForSelectedNamespace)"
                :loading="loading.nameList"
                @change="selectName($event.target.value)"
            ></e-select>
          </div>

          <div class="e-cell e-cell-small">
            <e-tooltip content="Load">
              <div id="load-button" class="e-btn e-btn-onlyicon" @click="loadSecret()" :disabled="!loadEnabled">
                <div class="e-btn__loading" :class="{ 'e-btn__loading-active': loading.secretLoad }">
                  <e-spinner data-size="small"></e-spinner>
                  <e-icon icon="folder-open"></e-icon>
                </div>
              </div>
            </e-tooltip>
          </div>

          <div class="e-cell e-cell-small">
            <e-tooltip content="Save">
              <div id="save-button" class="e-btn e-btn-onlyicon" @click="saveSecret()" :disabled="!saveEnabled">
                <div class="e-btn__loading" :class="{ 'e-btn__loading-active': loading.secretSave }">
                  <e-spinner data-size="small"></e-spinner>
                  <e-icon icon="floppy-o"></e-icon>
                </div>
              </div>
            </e-tooltip>
          </div>

          <div class="e-cell e-cell-small">
            <e-tooltip content="Load Backup to editor">
              <backup-selector
                :available-times="availableBackupTimes"
                :selected-time="selectedBackupTime"
                :disabled="!backupEnabled"
                @input="loadSelectedBackup($event)"
              />
            </e-tooltip>
          </div>

          <div class="e-cell e-cell-small" style="margin-left: auto">
            <div style="position: relative">
              <input
                  id="search-input"
                  ref="searchInput"
                  class="e-input e-input-large"
                  type="search"
                  placeholder="Search"
                  v-model="searchTerm"
                  style="padding-left: 40px"
              />
              <e-icon icon="search" color="disabled" style="position: absolute; left: 12px; top: 7px;" />
            </div>
          </div>
        </div>

        <div class="e-margin-top-l" style="flex-grow: 1;">
          <div class="e-scrollable">
            <div class="e-scrollable__content">
              <secret-editor id="secret-editor" class="e-padding-s" v-if="secretLoaded" v-model="secret" :search-term="searchTerm">
              </secret-editor>
            </div>
          </div>
        </div>
      </section>
    </main>

    <div class="overlaycontainer" :class="{ 'e-hidden': !updateInProgress }">
      <div class="e-overlay e-overlay-centered" style="border-radius: 0">
        <div class="e-overlay__center">
          <e-spinner></e-spinner>
        </div>
      </div>
    </div>
  </div>
</div>
